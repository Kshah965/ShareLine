<div id="requests-modal-content">
    {% if item %}
    <div class="flex justify-between items-start gap-4 mb-6">
        <div class="flex-1">
            <h3 class="text-2xl font-bold mb-2">
                Requests for <span class="text-primary">{{ item.name }}</span>
            </h3>
            <div class="flex gap-2">
                <span class="badge badge-outline badge-lg">{{ item.category }}</span>
                <span class="badge badge-outline badge-lg">Qty: {{ item.quantity }}</span>
            </div>
        </div>
        <button type="button" class="btn btn-sm btn-circle btn-ghost" onclick="closeRequestsModal()">âœ•</button>
    </div>

    <div class="divider my-6"></div>

    {% if modal_message %}
    <div class="alert {{ 'alert-success' if modal_message.kind == 'success' else 'alert-error' }} mb-4 rounded-xl">
        <span>{{ modal_message.text }}</span>
    </div>
    {% endif %}

    {% if requests %}
    <div class="space-y-5 max-h-96 overflow-y-auto pr-2">
        {% for req in requests %}
        <div class="card bg-base-200 shadow-sm rounded-xl">
            <div class="card-body p-6">
                <div class="flex justify-between items-start gap-4 mb-4">
                    <div class="flex-1">
                        <h4 class="font-bold text-xl mb-3">
                            {{ req.requester_name or ('Request #' ~ req.model.id) }}
                        </h4>
                        <div class="flex gap-3 text-sm">
                            <span class="badge badge-ghost badge-lg">Qty: {{ req.model.requested_quantity }}</span>
                            <span class="badge badge-lg {{ 'badge-warning' if req.model.status == 'Pending' else ('badge-success' if req.model.status == 'Approved' else 'badge-error') }}">
                                {{ req.model.status }}
                            </span>
                        </div>
                    </div>
                </div>
                {% if req.model.status == 'Pending' %}
                <div class="card-actions justify-end pt-4 border-t border-base-300">
                    <form
                        hx-post="/ui/donor/requests/{{ req.model.id }}/status"
                        hx-target="#requests-modal-content"
                        hx-swap="outerHTML"
                        class="flex gap-3"
                    >
                        <button type="submit" class="btn btn-success gap-2 min-w-32" name="status" value="Approved">
                            Accept
                        </button>
                        <button type="submit" class="btn btn-error gap-2 min-w-32" name="status" value="Rejected">
                            Decline
                        </button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="py-12 text-center">
        <p class="text-base-content/70 text-lg">No requests yet</p>
        <p class="text-base-content/50 text-sm mt-2">When students request this item, they'll appear here.</p>
    </div>
    {% endif %}
    {% else %}
    <div class="text-center py-12">
        <p class="text-base-content/70">Item not found or not accessible.</p>
    </div>
    {% endif %}

    <div class="flex justify-end gap-3 mt-8 pt-6 border-t border-base-300">
        <button type="button" class="btn btn-lg min-w-32" onclick="closeRequestsModal()">Close</button>
    </div>
</div>
